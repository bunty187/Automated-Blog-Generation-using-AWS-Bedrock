# Automated-Blog-Generation-using-AWS-Bedrock

This project leverages AWS Bedrock, the Llama model, AWS Lambda functions, and an S3 bucket to automate blog generation. Postman is used to interact with the API.

## Table of Contents
1. [Environment Setup](#environment-setup)
2. [Writing Code in AWS Lambda](#writing-code-in-aws-lambda)
3. [Hitting API using Postman](#hitting-api-using-postman)
4. [Downloading Data from s3 Bucket](#downloading-data-from-s3-bucket)


## Environment Setup
1. Create the Virtual Environment:
   * Navigate to your project directory in the terminal and run the following command to create a virtual environment
   * ```
     conda create -p blog_generation python==3.12 -y
     ````
2. Activate the Virtual Environment:
   * ```
     conda activate blog_generation/
     ```
3. Install Dependencies:
   * ```
     pip install -r requirements.txt
     ```
4. Create an AWS Account:
   * sign up at [AWS](https://aws.amazon.com/free/?gclid=CjwKCAjw7s20BhBFEiwABVIMrbgs05gFnAk8X9yETT2vVUQcAcyhPT64-JgwuPvVAFyts4pC2KgJBBoC644QAvD_BwE&trk=2738afd4-9401-4d18-8e3e-1b1c194dea07&sc_channel=ps&ef_id=CjwKCAjw7s20BhBFEiwABVIMrbgs05gFnAk8X9yETT2vVUQcAcyhPT64-JgwuPvVAFyts4pC2KgJBBoC644QAvD_BwE:G:s&s_kwcid=AL!4422!3!509606977827!p!!g!!aws%20amazon%20com!12618685604!120373367976)

## Create S3 Bucket:
   * Go to the S3 console and create a new bucket (e.g., blog-generation-bucket).
## Set up AWS Lambda:
   * Go to the Lambda console and create a new function.
   * Choose "Author from scratch" and provide a function name (e.g., BlogGeneratorFunction).
   * Set the runtime to Python 3.x.
  
## Writing Code in AWS Lambda
   1.Lambda Function Code:
        * Use the following sample code for your Lambda function:
```
import boto3
import botocore.config
import json
# import response
from datatime import datatime

def blog_generate_using_bedrock(blogtopic:str)-> str:
    prompt = """<s>[INST]Human: Write a 300 words blog on the topic {blogtopic}.
    Assistant: [/INST]
    """

    body = {
        "prompt":prompt,
        "max_gen_len":512,
        "temperature":0.5,
        "top_p":0.9
    }

    try:
        bedrock = boto3.client("bedrock-runtime", region_name="us-east-1",
        config=botocore.config.Config(read_timeout=300, retries={"max_attempt":3}))

        response = bedrock.invoke_model(body=json.dumps(body),modelId="meta.llama2-70b-chat-v1")

        response_content= response.get('body').read()
        response_data=json.loads(response_content)
        print(response_data)

        blog_details= response_data['generation']
        return blog_details

    except Exception as e:
        print(f"Error generating the blog: {e}")
        return ""



def save_blog_details_s3(s3_key,s3_bucket):
    s3=boto3.client('s3')
    try:
        s3.put_object(Bucket=s3_bucket, Key=s3_key, Body=generate_blog)
        print("Code saved to s3")

    except Exception as e:
        print("Error when saving the code to s3")


def lambda_handler(event,context):
    ### TODO Imlement
    event = json.loads(event['body'])
    blogtopic = event['blog_topic']

    generate_blog = blog_generate_using_bedrock(blogtopic=blogtopic)

    if generate_blog:
        current_time= datatime.now().strftime("%H%M%S")
        s3_key= f"blog-output/{current_time}.md"
        s3_bucket = 'aws_bedrock_course1'
        save_blog_details_s3(s3_key,s3_bucket, generate_blog)
    else:
        print("No blog was generated")


    return {
            "statusCode":200,
            "body":json.dumps('Blog Generation')
        }

```

2. Deploy the Function:
   * Save and deploy your Lambda function.

## Hitting API using Postman
   1. Set up Postman:
      * Install Postman
      * Open Postman and create a new request.
  2. Configure the Request:
     * Set the request type to POST.
     * Enter the API Gateway URL generated by AWS Lambda.
     * In the "Body" tab, choose "raw" and set the format to JSON.
     * Provide the input JSON, e.g.,

```
{
    "topic": "Machine Learning and Generative AI"
}
```
3. Send the Request:
   * Hit the "Send" button.
   * The response will contain the URL to the generated blog content in the S3 bucket.
    
## Downloading Data from S3 Bucket
  * Access the S3 Console:
  * Go to the S3 console in your AWS account.
  * Navigate to Your Bucket:
  * Open the blog-generation-bucket.
  1. Download the File:
      * Locate the generated blog file (e.g., %H%M%S.md).
      * Select the file and click on the "Download" button.
